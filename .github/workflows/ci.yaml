---
# https://github.com/chezmoi/dotfiles/blob/master/.github/workflows/ci.yaml
name: ci

on: # yamllint disable-line rule:truthy
  # push:
  # pull_request:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  clone-and-install:
    runs-on: ${{ matrix.os }}
    container:
      # https://github.com/devcontainers/images/releases
      image: mcr.microsoft.com/vscode/devcontainers/${{ matrix.image }}@a5328e06b77f7d01e6d66910155978db71716f2b # v0.4.19
      env:
        CHEZMOI_PROFILE: minimal
        # CODESPACES: true
    steps:
      - uses: actions/checkout@v5
        with:
          persist-credentials: false
      - run: ./script/bootstrap
      - run: mise run check
      - name: chezmoi data
        run: '"$HOME/.local/bin/chezmoi" data'
    strategy:
      matrix:
        # https://github.com/actions/runner-images/tree/main/images
        os: [ubuntu-latest]
        # https://hub.docker.com/r/microsoft/vscode-devcontainers
        # https://mcr.microsoft.com/v2/vscode/devcontainers/base/tags/list
        image:
          - base:alpine
          # - base:debian
          # - base:ubuntu
