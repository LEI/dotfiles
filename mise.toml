redactions = [
  # "API_KEY",
  "*_TOKEN",
  # "PASSWORD",
]

[task_config]
includes = ["script"]

# PATH="$PATH:$HOME/.local/bin"
# # Add shims on PATH unless mise is already activated
# if [ -z "${MISE_SHELL:-}" ]; then
#   PATH="$PATH:$HOME/.local/share/mise/shims"
# fi

[tasks.check]
alias = ["c"]
run = [
  # "chezmoi feature list",
  # "chezmoi package diff all",
  # "chezmoi managed | grep '.chezmoiscript\\|.local/bin\\|install-'",
  # "atuin doctor",
  # "brew doctor",
  # "chezmoi doctor --dry-run --no-network",
  """[ -n "${MISE_SHELL:-}" ] || PATH="$PATH:$HOME/.local/share/mise/shims"; mise doctor""",

  # # timeout 5m nvim --headless +checkhealth +qa # >/dev/null
  # "timeout 5m nvim --headless try \\| +checkhealth \\| +quitall \\| catch \\| +cquitall \\| end >/dev/null; echo",
]

[tasks.update]
run = [
  # if [ "$(nvim --headless -u NONE "+echo has('nvim-0.8')" +qa 2>&1)" = 1 ]; then
  # timeout 5m nvim --headless +LazyUpdate! +qa # >/dev/null
  "! command -v nvim >/dev/null || timeout 5m nvim --headless try \\| +LazyUpdate! \\| +quitall \\| catch \\| +cquitall \\| end; echo",

  # export TMUX_PLUGIN_MANAGER_PATH="$HOME/.config/tmux/plugins/"
  "! command -v tmux >/dev/null || timeout 5m ~/.config/tmux/plugins/tpm/bin/update_plugins all",
]

[tasks.embed]
run = """
#!/bin/sh
if [ -n "ok" ]; then
  echo ok
fi
"""
